"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.httpsRequest = void 0;
const https = require("https");
function httpsRequest(url, options = {}, encoding = 'utf8') {
    return new Promise((resolve, reject) => {
        https.request(url, options, res => {
            if (res.statusCode === 301 || res.statusCode === 302) { // follow redirects
                return resolve(httpsRequest(res.headers.location, options, encoding));
            }
            if (res.statusCode !== 200) {
                return reject(res.statusMessage);
            }
            let body = '';
            res.setEncoding(encoding)
                .on('data', data => body += data)
                .on('end', () => resolve(body));
        })
            .on('error', reject)
            .end();
    });
}
exports.httpsRequest = httpsRequest;
//# sourceMappingURL=utils.js.map