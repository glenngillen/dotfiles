"use strict";
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
Object.defineProperty(exports, "__esModule", { value: true });
const fs = require("fs");
const constants = require("constants");
const cp = require("child_process");
const assert = require("assert");
const net = require("net");
const protocolClient_1 = require("./protocolClient");
class DebugClient extends protocolClient_1.ProtocolClient {
    /**
     * Creates a DebugClient object that provides a promise-based API to write
     * debug adapter tests.
     * A simple mocha example for setting and hitting a breakpoint in line 15 of a program 'test.js' looks like this:
     *
     * var dc;
     * setup( () => {
     *     dc = new DebugClient('node', './out/node/nodeDebug.js', 'node');
     *     return dc.start();
     * });
     * teardown( () => dc.stop() );
     *
     * test('should stop on a breakpoint', () => {
     *     return dc.hitBreakpoint({ program: 'test.js' }, 'test.js', 15);
     * });
     */
    constructor(runtime, executable, debugType, spawnOptions, enableStderr) {
        super();
        this.defaultTimeout = 5000;
        this._runtime = runtime;
        this._executable = executable;
        this._spawnOptions = spawnOptions;
        this._enableStderr = enableStderr;
        this._debugType = debugType;
        this._supportsConfigurationDoneRequest = false;
        if (DebugClient.CASE_INSENSITIVE_FILESYSTEM === undefined) {
            try {
                fs.accessSync(process.execPath.toLowerCase(), constants.F_OK);
                fs.accessSync(process.execPath.toUpperCase(), constants.F_OK);
                DebugClient.CASE_INSENSITIVE_FILESYSTEM = true;
            }
            catch (err) {
                DebugClient.CASE_INSENSITIVE_FILESYSTEM = false;
            }
        }
    }
    // ---- life cycle --------------------------------------------------------------------------------------------------------
    /**
     * Starts a new debug adapter and sets up communication via stdin/stdout.
     * If a port number is specified the adapter is not launched but a connection to
     * a debug adapter running in server mode is established. This is useful for debugging
     * the adapter while running tests. For this reason all timeouts are disabled in server mode.
     */
    start(port) {
        return new Promise((resolve, reject) => {
            if (typeof port === 'number') {
                this._socket = net.createConnection(port, '127.0.0.1', () => {
                    this.connect(this._socket, this._socket);
                    resolve();
                });
            }
            else {
                this._adapterProcess = cp.spawn(this._runtime, [this._executable], this._spawnOptions);
                const sanitize = (s) => s.toString().replace(/\r?\n$/mg, '');
                this._adapterProcess.stderr.on('data', (data) => {
                    if (this._enableStderr) {
                        console.log(sanitize(data));
                    }
                });
                this._adapterProcess.on('error', (err) => {
                    console.log(err);
                    reject(err);
                });
                this._adapterProcess.on('exit', (code, signal) => {
                    if (code) {
                        // done(new Error('debug adapter exit code: ' + code));
                    }
                });
                this.connect(this._adapterProcess.stdout, this._adapterProcess.stdin);
                resolve();
            }
        });
    }
    /**
     * Shutdown the debuggee and the debug adapter (or disconnect if in server mode).
     */
    stop() {
        return this.disconnectRequest().then(() => {
            this.stopAdapter();
        }).catch(() => {
            this.stopAdapter();
        });
    }
    stopAdapter() {
        if (this._adapterProcess) {
            this._adapterProcess.kill();
            this._adapterProcess = null;
        }
        if (this._socket) {
            this._socket.end();
            this._socket = null;
        }
    }
    // ---- protocol requests -------------------------------------------------------------------------------------------------
    initializeRequest(args) {
        if (!args) {
            args = {
                adapterID: this._debugType,
                linesStartAt1: true,
                columnsStartAt1: true,
                pathFormat: 'path'
            };
        }
        return this.send('initialize', args);
    }
    configurationDoneRequest(args) {
        return this.send('configurationDone', args);
    }
    launchRequest(args) {
        return this.send('launch', args);
    }
    attachRequest(args) {
        return this.send('attach', args);
    }
    restartRequest(args) {
        return this.send('restart', args);
    }
    terminateRequest(args) {
        return this.send('terminate', args);
    }
    disconnectRequest(args) {
        return this.send('disconnect', args);
    }
    setBreakpointsRequest(args) {
        return this.send('setBreakpoints', args);
    }
    setFunctionBreakpointsRequest(args) {
        return this.send('setFunctionBreakpoints', args);
    }
    setExceptionBreakpointsRequest(args) {
        return this.send('setExceptionBreakpoints', args);
    }
    continueRequest(args) {
        return this.send('continue', args);
    }
    nextRequest(args) {
        return this.send('next', args);
    }
    stepInRequest(args) {
        return this.send('stepIn', args);
    }
    stepOutRequest(args) {
        return this.send('stepOut', args);
    }
    stepBackRequest(args) {
        return this.send('stepBack', args);
    }
    reverseContinueRequest(args) {
        return this.send('reverseContinue', args);
    }
    restartFrameRequest(args) {
        return this.send('restartFrame', args);
    }
    gotoRequest(args) {
        return this.send('goto', args);
    }
    pauseRequest(args) {
        return this.send('pause', args);
    }
    stackTraceRequest(args) {
        return this.send('stackTrace', args);
    }
    scopesRequest(args) {
        return this.send('scopes', args);
    }
    variablesRequest(args) {
        return this.send('variables', args);
    }
    setVariableRequest(args) {
        return this.send('setVariable', args);
    }
    sourceRequest(args) {
        return this.send('source', args);
    }
    threadsRequest() {
        return this.send('threads');
    }
    modulesRequest(args) {
        return this.send('modules');
    }
    evaluateRequest(args) {
        return this.send('evaluate', args);
    }
    stepInTargetsRequest(args) {
        return this.send('stepInTargets', args);
    }
    gotoTargetsRequest(args) {
        return this.send('gotoTargets', args);
    }
    completionsRequest(args) {
        return this.send('completions', args);
    }
    exceptionInfoRequest(args) {
        return this.send('exceptionInfo', args);
    }
    customRequest(command, args) {
        return this.send(command, args);
    }
    // ---- convenience methods -----------------------------------------------------------------------------------------------
    /*
     * Returns a promise that will resolve if an event with a specific type was received within some specified time.
     * The promise will be rejected if a timeout occurs.
     */
    waitForEvent(eventType, timeout) {
        timeout = timeout || this.defaultTimeout;
        return new Promise((resolve, reject) => {
            this.once(eventType, event => {
                resolve(event);
            });
            if (!this._socket) { // no timeouts if debugging the tests
                setTimeout(() => {
                    reject(new Error(`no event '${eventType}' received after ${timeout} ms`));
                }, timeout);
            }
        });
    }
    /*
     * Returns a promise that will resolve if an 'initialized' event was received within some specified time
     * and a subsequent 'configurationDone' request was successfully executed.
     * The promise will be rejected if a timeout occurs or if the 'configurationDone' request fails.
     */
    configurationSequence() {
        return this.waitForEvent('initialized').then(event => {
            return this.configurationDone();
        });
    }
    /**
     * Returns a promise that will resolve if a 'initialize' and a 'launch' request were successful.
     */
    launch(launchArgs) {
        return this.initializeRequest().then(response => {
            if (response.body && response.body.supportsConfigurationDoneRequest) {
                this._supportsConfigurationDoneRequest = true;
            }
            return this.launchRequest(launchArgs);
        });
    }
    configurationDone() {
        if (this._supportsConfigurationDoneRequest) {
            return this.configurationDoneRequest();
        }
        else {
            // if debug adapter doesn't support the configurationDoneRequest we have to send the setExceptionBreakpointsRequest.
            return this.setExceptionBreakpointsRequest({ filters: ['all'] });
        }
    }
    /*
     * Returns a promise that will resolve if a 'stopped' event was received within some specified time
     * and the event's reason and line number was asserted.
     * The promise will be rejected if a timeout occurs, the assertions fail, or if the 'stackTrace' request fails.
     */
    assertStoppedLocation(reason, expected) {
        return this.waitForEvent('stopped').then(event => {
            assert.equal(event.body.reason, reason);
            return this.stackTraceRequest({
                threadId: event.body.threadId
            });
        }).then(response => {
            const frame = response.body.stackFrames[0];
            if (typeof expected.path === 'string' || expected.path instanceof RegExp) {
                this.assertPath(frame.source.path, expected.path, 'stopped location: path mismatch');
            }
            if (typeof expected.line === 'number') {
                assert.equal(frame.line, expected.line, 'stopped location: line mismatch');
            }
            if (typeof expected.column === 'number') {
                assert.equal(frame.column, expected.column, 'stopped location: column mismatch');
            }
            return response;
        });
    }
    assertPartialLocationsEqual(locA, locB) {
        if (locA.path) {
            this.assertPath(locA.path, locB.path, 'breakpoint verification mismatch: path');
        }
        if (typeof locA.line === 'number') {
            assert.equal(locA.line, locB.line, 'breakpoint verification mismatch: line');
        }
        if (typeof locB.column === 'number' && typeof locA.column === 'number') {
            assert.equal(locA.column, locB.column, 'breakpoint verification mismatch: column');
        }
    }
    /*
     * Returns a promise that will resolve if enough output events with the given category have been received
     * and the concatenated data match the expected data.
     * The promise will be rejected as soon as the received data cannot match the expected data or if a timeout occurs.
     */
    assertOutput(category, expected, timeout) {
        timeout = timeout || this.defaultTimeout;
        return new Promise((resolve, reject) => {
            let output = '';
            this.on('output', event => {
                const e = event;
                if (e.body.category === category) {
                    output += e.body.output;
                    if (output.indexOf(expected) === 0) {
                        resolve(event);
                    }
                    else if (expected.indexOf(output) !== 0) {
                        const sanitize = (s) => s.toString().replace(/\r/mg, '\\r').replace(/\n/mg, '\\n');
                        reject(new Error(`received data '${sanitize(output)}' is not a prefix of the expected data '${sanitize(expected)}'`));
                    }
                }
            });
            if (!this._socket) { // no timeouts if debugging the tests
                setTimeout(() => {
                    reject(new Error(`not enough output data received after ${timeout} ms`));
                }, timeout);
            }
        });
    }
    assertPath(path, expected, message) {
        if (expected instanceof RegExp) {
            assert.ok(expected.test(path), message);
        }
        else {
            if (DebugClient.CASE_INSENSITIVE_FILESYSTEM) {
                if (typeof path === 'string') {
                    path = path.toLowerCase();
                }
                if (typeof expected === 'string') {
                    expected = expected.toLowerCase();
                }
            }
            assert.equal(path, expected, message);
        }
    }
    // ---- scenarios ---------------------------------------------------------------------------------------------------------
    /**
     * Returns a promise that will resolve if a configurable breakpoint has been hit within some time
     * and the event's reason and line number was asserted.
     * The promise will be rejected if a timeout occurs, the assertions fail, or if the requests fails.
     */
    hitBreakpoint(launchArgs, location, expectedStopLocation, expectedBPLocation) {
        return Promise.all([
            this.waitForEvent('initialized').then(event => {
                return this.setBreakpointsRequest({
                    lines: [location.line],
                    breakpoints: [{ line: location.line, column: location.column }],
                    source: { path: location.path }
                });
            }).then(response => {
                const bp = response.body.breakpoints[0];
                const verified = (typeof location.verified === 'boolean') ? location.verified : true;
                assert.equal(bp.verified, verified, 'breakpoint verification mismatch: verified');
                const actualLocation = {
                    column: bp.column,
                    line: bp.line,
                    path: bp.source && bp.source.path
                };
                this.assertPartialLocationsEqual(actualLocation, expectedBPLocation || location);
                return this.configurationDone();
            }),
            this.launch(launchArgs),
            this.assertStoppedLocation('breakpoint', expectedStopLocation || location)
        ]);
    }
}
exports.DebugClient = DebugClient;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVidWdDbGllbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvZGVidWdDbGllbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Z0dBR2dHOztBQUVoRyx5QkFBMEI7QUFDMUIsdUNBQXdDO0FBQ3hDLG9DQUFxQztBQUNyQyxpQ0FBa0M7QUFDbEMsMkJBQTRCO0FBRTVCLHFEQUFnRDtBQWdCaEQsTUFBYSxXQUFZLFNBQVEsK0JBQWM7SUFnQjlDOzs7Ozs7Ozs7Ozs7Ozs7T0FlRztJQUNILFlBQVksT0FBZSxFQUFFLFVBQWtCLEVBQUUsU0FBaUIsRUFBRSxZQUE4QixFQUFFLFlBQXNCO1FBQ3pILEtBQUssRUFBRSxDQUFDO1FBbkJGLG1CQUFjLEdBQUcsSUFBSSxDQUFDO1FBb0I1QixJQUFJLENBQUMsUUFBUSxHQUFHLE9BQU8sQ0FBQztRQUN4QixJQUFJLENBQUMsV0FBVyxHQUFHLFVBQVUsQ0FBQztRQUM5QixJQUFJLENBQUMsYUFBYSxHQUFHLFlBQVksQ0FBQztRQUNsQyxJQUFJLENBQUMsYUFBYSxHQUFHLFlBQVksQ0FBQztRQUNsQyxJQUFJLENBQUMsVUFBVSxHQUFHLFNBQVMsQ0FBQztRQUM1QixJQUFJLENBQUMsaUNBQWlDLEdBQUcsS0FBSyxDQUFDO1FBRS9DLElBQUksV0FBVyxDQUFDLDJCQUEyQixLQUFLLFNBQVMsRUFBRTtZQUMxRCxJQUFJO2dCQUNILEVBQUUsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxXQUFXLEVBQUUsRUFBRSxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQzlELEVBQUUsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxXQUFXLEVBQUUsRUFBRSxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQzlELFdBQVcsQ0FBQywyQkFBMkIsR0FBRyxJQUFJLENBQUM7YUFDL0M7WUFBQyxPQUFPLEdBQUcsRUFBRTtnQkFDYixXQUFXLENBQUMsMkJBQTJCLEdBQUcsS0FBSyxDQUFDO2FBQ2hEO1NBQ0Q7SUFDRixDQUFDO0lBRUQsMkhBQTJIO0lBRTNIOzs7OztPQUtHO0lBQ0ksS0FBSyxDQUFDLElBQWE7UUFFekIsT0FBTyxJQUFJLE9BQU8sQ0FBTyxDQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUUsRUFBRTtZQUM1QyxJQUFJLE9BQU8sSUFBSSxLQUFLLFFBQVEsRUFBRTtnQkFDN0IsSUFBSSxDQUFDLE9BQU8sR0FBRyxHQUFHLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxFQUFFLFdBQVcsRUFBRSxHQUFHLEVBQUU7b0JBQzNELElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7b0JBQ3pDLE9BQU8sRUFBRSxDQUFDO2dCQUNYLENBQUMsQ0FBQyxDQUFDO2FBQ0g7aUJBQU07Z0JBQ04sSUFBSSxDQUFDLGVBQWUsR0FBRyxFQUFFLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBRSxJQUFJLENBQUMsV0FBVyxDQUFFLEVBQUUsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO2dCQUN6RixNQUFNLFFBQVEsR0FBRyxDQUFDLENBQVMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsRUFBRSxDQUFDLENBQUM7Z0JBQ3JFLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxJQUFZLEVBQUUsRUFBRTtvQkFDdkQsSUFBSSxJQUFJLENBQUMsYUFBYSxFQUFFO3dCQUN2QixPQUFPLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO3FCQUM1QjtnQkFDRixDQUFDLENBQUMsQ0FBQztnQkFFSCxJQUFJLENBQUMsZUFBZSxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxHQUFHLEVBQUUsRUFBRTtvQkFDeEMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztvQkFDakIsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUNiLENBQUMsQ0FBQyxDQUFDO2dCQUNILElBQUksQ0FBQyxlQUFlLENBQUMsRUFBRSxDQUFDLE1BQU0sRUFBRSxDQUFDLElBQVksRUFBRSxNQUFjLEVBQUUsRUFBRTtvQkFDaEUsSUFBSSxJQUFJLEVBQUU7d0JBQ1QsdURBQXVEO3FCQUN2RDtnQkFDRixDQUFDLENBQUMsQ0FBQztnQkFFSCxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxlQUFlLENBQUMsS0FBSyxDQUFDLENBQUM7Z0JBQ3RFLE9BQU8sRUFBRSxDQUFDO2FBQ1Y7UUFDRixDQUFDLENBQUMsQ0FBQztJQUNKLENBQUM7SUFFRDs7T0FFRztJQUNJLElBQUk7UUFFVixPQUFPLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUU7WUFDekMsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ3BCLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLEVBQUU7WUFDYixJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDcEIsQ0FBQyxDQUFDLENBQUM7SUFDSixDQUFDO0lBRU8sV0FBVztRQUNsQixJQUFJLElBQUksQ0FBQyxlQUFlLEVBQUU7WUFDekIsSUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUM1QixJQUFJLENBQUMsZUFBZSxHQUFHLElBQUksQ0FBQztTQUM1QjtRQUNELElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNqQixJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxDQUFDO1lBQ25CLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDO1NBQ3BCO0lBQ0YsQ0FBQztJQUVELDJIQUEySDtJQUVwSCxpQkFBaUIsQ0FBQyxJQUErQztRQUN2RSxJQUFJLENBQUMsSUFBSSxFQUFFO1lBQ1YsSUFBSSxHQUFHO2dCQUNOLFNBQVMsRUFBRSxJQUFJLENBQUMsVUFBVTtnQkFDMUIsYUFBYSxFQUFFLElBQUk7Z0JBQ25CLGVBQWUsRUFBRSxJQUFJO2dCQUNyQixVQUFVLEVBQUUsTUFBTTthQUNsQixDQUFDO1NBQ0Y7UUFDRCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3RDLENBQUM7SUFFTSx3QkFBd0IsQ0FBQyxJQUErQztRQUM5RSxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDN0MsQ0FBQztJQUVNLGFBQWEsQ0FBQyxJQUEwQztRQUM5RCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFFTSxhQUFhLENBQUMsSUFBMEM7UUFDOUQsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNsQyxDQUFDO0lBRU0sY0FBYyxDQUFDLElBQW9DO1FBQ3pELE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDbkMsQ0FBQztJQUVNLGdCQUFnQixDQUFDLElBQXVDO1FBQzlELE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDckMsQ0FBQztJQUVNLGlCQUFpQixDQUFDLElBQXdDO1FBQ2hFLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDdEMsQ0FBQztJQUVNLHFCQUFxQixDQUFDLElBQTJDO1FBQ3ZFLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUMxQyxDQUFDO0lBRU0sNkJBQTZCLENBQUMsSUFBbUQ7UUFDdkYsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLHdCQUF3QixFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ2xELENBQUM7SUFFTSw4QkFBOEIsQ0FBQyxJQUFvRDtRQUN6RixPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMseUJBQXlCLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDbkQsQ0FBQztJQUVNLGVBQWUsQ0FBQyxJQUFxQztRQUMzRCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3BDLENBQUM7SUFFTSxXQUFXLENBQUMsSUFBaUM7UUFDbkQsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNoQyxDQUFDO0lBRU0sYUFBYSxDQUFDLElBQW1DO1FBQ3ZELE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDbEMsQ0FBQztJQUVNLGNBQWMsQ0FBQyxJQUFvQztRQUN6RCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ25DLENBQUM7SUFFTSxlQUFlLENBQUMsSUFBcUM7UUFDM0QsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNwQyxDQUFDO0lBRU0sc0JBQXNCLENBQUMsSUFBNEM7UUFDekUsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLGlCQUFpQixFQUFFLElBQUksQ0FBQyxDQUFDO0lBQzNDLENBQUM7SUFFTSxtQkFBbUIsQ0FBQyxJQUF5QztRQUNuRSxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3hDLENBQUM7SUFFTSxXQUFXLENBQUMsSUFBaUM7UUFDbkQsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNoQyxDQUFDO0lBRU0sWUFBWSxDQUFDLElBQWtDO1FBQ3JELE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDakMsQ0FBQztJQUVNLGlCQUFpQixDQUFDLElBQXVDO1FBQy9ELE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDdEMsQ0FBQztJQUVNLGFBQWEsQ0FBQyxJQUFtQztRQUN2RCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFFTSxnQkFBZ0IsQ0FBQyxJQUFzQztRQUM3RCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3JDLENBQUM7SUFFTSxrQkFBa0IsQ0FBQyxJQUF3QztRQUNqRSxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3ZDLENBQUM7SUFFTSxhQUFhLENBQUMsSUFBbUM7UUFDdkQsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNsQyxDQUFDO0lBRU0sY0FBYztRQUNwQixPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDN0IsQ0FBQztJQUVNLGNBQWMsQ0FBQyxJQUFvQztRQUN6RCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDN0IsQ0FBQztJQUVNLGVBQWUsQ0FBQyxJQUFxQztRQUMzRCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3BDLENBQUM7SUFFTSxvQkFBb0IsQ0FBQyxJQUEwQztRQUNyRSxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsZUFBZSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3pDLENBQUM7SUFFTSxrQkFBa0IsQ0FBQyxJQUF3QztRQUNqRSxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3ZDLENBQUM7SUFFTSxrQkFBa0IsQ0FBQyxJQUF3QztRQUNqRSxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3ZDLENBQUM7SUFFTSxvQkFBb0IsQ0FBQyxJQUEwQztRQUNyRSxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsZUFBZSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ3pDLENBQUM7SUFFTSxhQUFhLENBQUMsT0FBZSxFQUFFLElBQVU7UUFDL0MsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNqQyxDQUFDO0lBRUQsMkhBQTJIO0lBRTNIOzs7T0FHRztJQUNJLFlBQVksQ0FBQyxTQUFpQixFQUFFLE9BQWdCO1FBRXRELE9BQU8sR0FBRyxPQUFPLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQztRQUV6QyxPQUFPLElBQUksT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxFQUFFO1lBQ3RDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLEtBQUssQ0FBQyxFQUFFO2dCQUM1QixPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDaEIsQ0FBQyxDQUFDLENBQUM7WUFDSCxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxFQUFFLHFDQUFxQztnQkFDekQsVUFBVSxDQUFDLEdBQUcsRUFBRTtvQkFDZixNQUFNLENBQUMsSUFBSSxLQUFLLENBQUMsYUFBYSxTQUFTLG9CQUFvQixPQUFPLEtBQUssQ0FBQyxDQUFDLENBQUM7Z0JBQzNFLENBQUMsRUFBRSxPQUFPLENBQUMsQ0FBQzthQUNaO1FBQ0YsQ0FBQyxDQUFDLENBQUM7SUFDSixDQUFDO0lBRUQ7Ozs7T0FJRztJQUNJLHFCQUFxQjtRQUUzQixPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsYUFBYSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFO1lBQ3BELE9BQU8sSUFBSSxDQUFDLGlCQUFpQixFQUFFLENBQUM7UUFDakMsQ0FBQyxDQUFDLENBQUM7SUFDSixDQUFDO0lBRUQ7O09BRUc7SUFDSSxNQUFNLENBQUMsVUFBZTtRQUU1QixPQUFPLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRTtZQUMvQyxJQUFJLFFBQVEsQ0FBQyxJQUFJLElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxnQ0FBZ0MsRUFBRTtnQkFDcEUsSUFBSSxDQUFDLGlDQUFpQyxHQUFHLElBQUksQ0FBQzthQUM5QztZQUNELE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUN2QyxDQUFDLENBQUMsQ0FBQztJQUNKLENBQUM7SUFFTyxpQkFBaUI7UUFDeEIsSUFBSSxJQUFJLENBQUMsaUNBQWlDLEVBQUU7WUFDM0MsT0FBTyxJQUFJLENBQUMsd0JBQXdCLEVBQUUsQ0FBQztTQUN2QzthQUFNO1lBQ04sb0hBQW9IO1lBQ3BILE9BQU8sSUFBSSxDQUFDLDhCQUE4QixDQUFDLEVBQUUsT0FBTyxFQUFFLENBQUUsS0FBSyxDQUFFLEVBQUUsQ0FBQyxDQUFDO1NBQ25FO0lBQ0YsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxxQkFBcUIsQ0FBQyxNQUFjLEVBQUUsUUFBb0U7UUFFaEgsT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUNoRCxNQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFDO1lBQ3hDLE9BQU8sSUFBSSxDQUFDLGlCQUFpQixDQUFDO2dCQUM3QixRQUFRLEVBQUUsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRO2FBQzdCLENBQUMsQ0FBQztRQUNKLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRTtZQUNsQixNQUFNLEtBQUssR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMzQyxJQUFJLE9BQU8sUUFBUSxDQUFDLElBQUksS0FBSyxRQUFRLElBQUksUUFBUSxDQUFDLElBQUksWUFBWSxNQUFNLEVBQUU7Z0JBQ3pFLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsUUFBUSxDQUFDLElBQUksRUFBRSxpQ0FBaUMsQ0FBQyxDQUFDO2FBQ3JGO1lBQ0QsSUFBSSxPQUFPLFFBQVEsQ0FBQyxJQUFJLEtBQUssUUFBUSxFQUFFO2dCQUN0QyxNQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsUUFBUSxDQUFDLElBQUksRUFBRSxpQ0FBaUMsQ0FBQyxDQUFDO2FBQzNFO1lBQ0QsSUFBSSxPQUFPLFFBQVEsQ0FBQyxNQUFNLEtBQUssUUFBUSxFQUFFO2dCQUN4QyxNQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsUUFBUSxDQUFDLE1BQU0sRUFBRSxtQ0FBbUMsQ0FBQyxDQUFDO2FBQ2pGO1lBQ0QsT0FBTyxRQUFRLENBQUM7UUFDakIsQ0FBQyxDQUFDLENBQUM7SUFDSixDQUFDO0lBRU8sMkJBQTJCLENBQUMsSUFBc0IsRUFBRSxJQUFzQjtRQUNqRixJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUU7WUFDZCxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUksRUFBRSx3Q0FBd0MsQ0FBQyxDQUFDO1NBQ2hGO1FBQ0QsSUFBSSxPQUFPLElBQUksQ0FBQyxJQUFJLEtBQUssUUFBUSxFQUFFO1lBQ2xDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxFQUFFLHdDQUF3QyxDQUFDLENBQUM7U0FDN0U7UUFDRCxJQUFJLE9BQU8sSUFBSSxDQUFDLE1BQU0sS0FBSyxRQUFRLElBQUksT0FBTyxJQUFJLENBQUMsTUFBTSxLQUFLLFFBQVEsRUFBRTtZQUN2RSxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLE1BQU0sRUFBRSwwQ0FBMEMsQ0FBQyxDQUFDO1NBQ25GO0lBQ0YsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxZQUFZLENBQUMsUUFBZ0IsRUFBRSxRQUFnQixFQUFFLE9BQWdCO1FBRXZFLE9BQU8sR0FBRyxPQUFPLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQztRQUV6QyxPQUFPLElBQUksT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxFQUFFO1lBQ3RDLElBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQztZQUNoQixJQUFJLENBQUMsRUFBRSxDQUFDLFFBQVEsRUFBRSxLQUFLLENBQUMsRUFBRTtnQkFDekIsTUFBTSxDQUFDLEdBQStCLEtBQUssQ0FBQztnQkFDNUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsS0FBSyxRQUFRLEVBQUU7b0JBQ2pDLE1BQU0sSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQztvQkFDeEIsSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsRUFBRTt3QkFDbkMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO3FCQUNmO3lCQUFNLElBQUksUUFBUSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUU7d0JBQzFDLE1BQU0sUUFBUSxHQUFHLENBQUMsQ0FBUyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFLEtBQUssQ0FBQyxDQUFDO3dCQUMzRixNQUFNLENBQUMsSUFBSSxLQUFLLENBQUMsa0JBQWtCLFFBQVEsQ0FBQyxNQUFNLENBQUMsMkNBQTJDLFFBQVEsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztxQkFDdEg7aUJBQ0Q7WUFDRixDQUFDLENBQUMsQ0FBQztZQUNILElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLEVBQUUscUNBQXFDO2dCQUN6RCxVQUFVLENBQUMsR0FBRyxFQUFFO29CQUNmLE1BQU0sQ0FBQyxJQUFJLEtBQUssQ0FBQyx5Q0FBeUMsT0FBTyxLQUFLLENBQUMsQ0FBQyxDQUFDO2dCQUMxRSxDQUFDLEVBQUUsT0FBTyxDQUFDLENBQUM7YUFDWjtRQUNGLENBQUMsQ0FBQyxDQUFDO0lBQ0osQ0FBQztJQUVNLFVBQVUsQ0FBQyxJQUFZLEVBQUUsUUFBeUIsRUFBRSxPQUFnQjtRQUUxRSxJQUFJLFFBQVEsWUFBWSxNQUFNLEVBQUU7WUFDL0IsTUFBTSxDQUFDLEVBQUUsQ0FBVSxRQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1NBQ2xEO2FBQU07WUFDTixJQUFJLFdBQVcsQ0FBQywyQkFBMkIsRUFBRTtnQkFDNUMsSUFBSSxPQUFPLElBQUksS0FBSyxRQUFRLEVBQUU7b0JBQzdCLElBQUksR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7aUJBQzFCO2dCQUNELElBQUksT0FBTyxRQUFRLEtBQUssUUFBUSxFQUFFO29CQUNqQyxRQUFRLEdBQVksUUFBUyxDQUFDLFdBQVcsRUFBRSxDQUFDO2lCQUM1QzthQUNEO1lBQ0QsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsUUFBUSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1NBQ3RDO0lBQ0YsQ0FBQztJQUVELDJIQUEySDtJQUUzSDs7OztPQUlHO0lBQ0ksYUFBYSxDQUFDLFVBQWUsRUFBRSxRQUFtQixFQUFFLG9CQUF1QyxFQUFFLGtCQUFxQztRQUV4SSxPQUFPLE9BQU8sQ0FBQyxHQUFHLENBQUM7WUFFbEIsSUFBSSxDQUFDLFlBQVksQ0FBQyxhQUFhLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUU7Z0JBQzdDLE9BQU8sSUFBSSxDQUFDLHFCQUFxQixDQUFDO29CQUNqQyxLQUFLLEVBQUUsQ0FBRSxRQUFRLENBQUMsSUFBSSxDQUFFO29CQUN4QixXQUFXLEVBQUUsQ0FBRSxFQUFFLElBQUksRUFBRSxRQUFRLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxRQUFRLENBQUMsTUFBTSxFQUFFLENBQUU7b0JBQ2pFLE1BQU0sRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLENBQUMsSUFBSSxFQUFFO2lCQUMvQixDQUFDLENBQUM7WUFDSixDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUU7Z0JBRWxCLE1BQU0sRUFBRSxHQUFHLFFBQVEsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUV4QyxNQUFNLFFBQVEsR0FBRyxDQUFDLE9BQU8sUUFBUSxDQUFDLFFBQVEsS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO2dCQUNyRixNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxRQUFRLEVBQUUsUUFBUSxFQUFFLDRDQUE0QyxDQUFDLENBQUM7Z0JBRWxGLE1BQU0sY0FBYyxHQUFjO29CQUNqQyxNQUFNLEVBQUUsRUFBRSxDQUFDLE1BQU07b0JBQ2pCLElBQUksRUFBRSxFQUFFLENBQUMsSUFBSTtvQkFDYixJQUFJLEVBQUUsRUFBRSxDQUFDLE1BQU0sSUFBSSxFQUFFLENBQUMsTUFBTSxDQUFDLElBQUk7aUJBQ2pDLENBQUM7Z0JBQ0YsSUFBSSxDQUFDLDJCQUEyQixDQUFDLGNBQWMsRUFBRSxrQkFBa0IsSUFBSSxRQUFRLENBQUMsQ0FBQztnQkFFakYsT0FBTyxJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztZQUNqQyxDQUFDLENBQUM7WUFFRixJQUFJLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQztZQUV2QixJQUFJLENBQUMscUJBQXFCLENBQUMsWUFBWSxFQUFFLG9CQUFvQixJQUFJLFFBQVEsQ0FBQztTQUUxRSxDQUFDLENBQUM7SUFDSixDQUFDO0NBQ0Q7QUFyYkQsa0NBcWJDIiwic291cmNlc0NvbnRlbnQiOlsiLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqICBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqICBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbmltcG9ydCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5pbXBvcnQgY29uc3RhbnRzID0gcmVxdWlyZSgnY29uc3RhbnRzJyk7XG5pbXBvcnQgY3AgPSByZXF1aXJlKCdjaGlsZF9wcm9jZXNzJyk7XG5pbXBvcnQgYXNzZXJ0ID0gcmVxdWlyZSgnYXNzZXJ0Jyk7XG5pbXBvcnQgbmV0ID0gcmVxdWlyZSgnbmV0Jyk7XG5pbXBvcnQge0RlYnVnUHJvdG9jb2x9IGZyb20gJ3ZzY29kZS1kZWJ1Z3Byb3RvY29sJztcbmltcG9ydCB7UHJvdG9jb2xDbGllbnR9IGZyb20gJy4vcHJvdG9jb2xDbGllbnQnO1xuXG5leHBvcnQgaW50ZXJmYWNlIElMb2NhdGlvbiB7XG5cdHBhdGg6IHN0cmluZztcblx0bGluZTogbnVtYmVyO1xuXHRjb2x1bW4/OiBudW1iZXI7XG5cdHZlcmlmaWVkPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJUGFydGlhbExvY2F0aW9uIHtcblx0cGF0aD86IHN0cmluZztcblx0bGluZT86IG51bWJlcjtcblx0Y29sdW1uPzogbnVtYmVyO1xuXHR2ZXJpZmllZD86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjbGFzcyBEZWJ1Z0NsaWVudCBleHRlbmRzIFByb3RvY29sQ2xpZW50IHtcblxuXHRwcml2YXRlIHN0YXRpYyBDQVNFX0lOU0VOU0lUSVZFX0ZJTEVTWVNURU0gOiBib29sZWFuO1xuXG5cdHByaXZhdGUgX3J1bnRpbWU6IHN0cmluZztcblx0cHJpdmF0ZSBfZXhlY3V0YWJsZTogc3RyaW5nO1xuXHRwcml2YXRlIF9hZGFwdGVyUHJvY2VzczogY3AuQ2hpbGRQcm9jZXNzO1xuXHRwcml2YXRlIF9zcGF3bk9wdGlvbnM6IGNwLlNwYXduT3B0aW9ucztcblx0cHJpdmF0ZSBfZW5hYmxlU3RkZXJyOiBib29sZWFuO1xuXHRwcml2YXRlIF9kZWJ1Z1R5cGU6IHN0cmluZztcblx0cHJpdmF0ZSBfc29ja2V0OiBuZXQuU29ja2V0O1xuXG5cdHByaXZhdGUgX3N1cHBvcnRzQ29uZmlndXJhdGlvbkRvbmVSZXF1ZXN0OiBib29sZWFuO1xuXG5cdHB1YmxpYyBkZWZhdWx0VGltZW91dCA9IDUwMDA7XG5cblx0LyoqXG5cdCAqIENyZWF0ZXMgYSBEZWJ1Z0NsaWVudCBvYmplY3QgdGhhdCBwcm92aWRlcyBhIHByb21pc2UtYmFzZWQgQVBJIHRvIHdyaXRlXG5cdCAqIGRlYnVnIGFkYXB0ZXIgdGVzdHMuXG5cdCAqIEEgc2ltcGxlIG1vY2hhIGV4YW1wbGUgZm9yIHNldHRpbmcgYW5kIGhpdHRpbmcgYSBicmVha3BvaW50IGluIGxpbmUgMTUgb2YgYSBwcm9ncmFtICd0ZXN0LmpzJyBsb29rcyBsaWtlIHRoaXM6XG5cdCAqXG5cdCAqIHZhciBkYztcblx0ICogc2V0dXAoICgpID0+IHtcblx0ICogICAgIGRjID0gbmV3IERlYnVnQ2xpZW50KCdub2RlJywgJy4vb3V0L25vZGUvbm9kZURlYnVnLmpzJywgJ25vZGUnKTtcblx0ICogICAgIHJldHVybiBkYy5zdGFydCgpO1xuXHQgKiB9KTtcblx0ICogdGVhcmRvd24oICgpID0+IGRjLnN0b3AoKSApO1xuXHQgKlxuXHQgKiB0ZXN0KCdzaG91bGQgc3RvcCBvbiBhIGJyZWFrcG9pbnQnLCAoKSA9PiB7XG5cdCAqICAgICByZXR1cm4gZGMuaGl0QnJlYWtwb2ludCh7IHByb2dyYW06ICd0ZXN0LmpzJyB9LCAndGVzdC5qcycsIDE1KTtcblx0ICogfSk7XG5cdCAqL1xuXHRjb25zdHJ1Y3RvcihydW50aW1lOiBzdHJpbmcsIGV4ZWN1dGFibGU6IHN0cmluZywgZGVidWdUeXBlOiBzdHJpbmcsIHNwYXduT3B0aW9ucz86IGNwLlNwYXduT3B0aW9ucywgZW5hYmxlU3RkZXJyPzogYm9vbGVhbikge1xuXHRcdHN1cGVyKCk7XG5cdFx0dGhpcy5fcnVudGltZSA9IHJ1bnRpbWU7XG5cdFx0dGhpcy5fZXhlY3V0YWJsZSA9IGV4ZWN1dGFibGU7XG5cdFx0dGhpcy5fc3Bhd25PcHRpb25zID0gc3Bhd25PcHRpb25zO1xuXHRcdHRoaXMuX2VuYWJsZVN0ZGVyciA9IGVuYWJsZVN0ZGVycjtcblx0XHR0aGlzLl9kZWJ1Z1R5cGUgPSBkZWJ1Z1R5cGU7XG5cdFx0dGhpcy5fc3VwcG9ydHNDb25maWd1cmF0aW9uRG9uZVJlcXVlc3QgPSBmYWxzZTtcblxuXHRcdGlmIChEZWJ1Z0NsaWVudC5DQVNFX0lOU0VOU0lUSVZFX0ZJTEVTWVNURU0gPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0ZnMuYWNjZXNzU3luYyhwcm9jZXNzLmV4ZWNQYXRoLnRvTG93ZXJDYXNlKCksIGNvbnN0YW50cy5GX09LKTtcblx0XHRcdFx0ZnMuYWNjZXNzU3luYyhwcm9jZXNzLmV4ZWNQYXRoLnRvVXBwZXJDYXNlKCksIGNvbnN0YW50cy5GX09LKTtcblx0XHRcdFx0RGVidWdDbGllbnQuQ0FTRV9JTlNFTlNJVElWRV9GSUxFU1lTVEVNID0gdHJ1ZTtcblx0XHRcdH0gY2F0Y2ggKGVycikge1xuXHRcdFx0XHREZWJ1Z0NsaWVudC5DQVNFX0lOU0VOU0lUSVZFX0ZJTEVTWVNURU0gPSBmYWxzZTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvLyAtLS0tIGxpZmUgY3ljbGUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXHQvKipcblx0ICogU3RhcnRzIGEgbmV3IGRlYnVnIGFkYXB0ZXIgYW5kIHNldHMgdXAgY29tbXVuaWNhdGlvbiB2aWEgc3RkaW4vc3Rkb3V0LlxuXHQgKiBJZiBhIHBvcnQgbnVtYmVyIGlzIHNwZWNpZmllZCB0aGUgYWRhcHRlciBpcyBub3QgbGF1bmNoZWQgYnV0IGEgY29ubmVjdGlvbiB0b1xuXHQgKiBhIGRlYnVnIGFkYXB0ZXIgcnVubmluZyBpbiBzZXJ2ZXIgbW9kZSBpcyBlc3RhYmxpc2hlZC4gVGhpcyBpcyB1c2VmdWwgZm9yIGRlYnVnZ2luZ1xuXHQgKiB0aGUgYWRhcHRlciB3aGlsZSBydW5uaW5nIHRlc3RzLiBGb3IgdGhpcyByZWFzb24gYWxsIHRpbWVvdXRzIGFyZSBkaXNhYmxlZCBpbiBzZXJ2ZXIgbW9kZS5cblx0ICovXG5cdHB1YmxpYyBzdGFydChwb3J0PzogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XG5cblx0XHRyZXR1cm4gbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0aWYgKHR5cGVvZiBwb3J0ID09PSAnbnVtYmVyJykge1xuXHRcdFx0XHR0aGlzLl9zb2NrZXQgPSBuZXQuY3JlYXRlQ29ubmVjdGlvbihwb3J0LCAnMTI3LjAuMC4xJywgKCkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuY29ubmVjdCh0aGlzLl9zb2NrZXQsIHRoaXMuX3NvY2tldCk7XG5cdFx0XHRcdFx0cmVzb2x2ZSgpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuX2FkYXB0ZXJQcm9jZXNzID0gY3Auc3Bhd24odGhpcy5fcnVudGltZSwgWyB0aGlzLl9leGVjdXRhYmxlIF0sIHRoaXMuX3NwYXduT3B0aW9ucyk7XG5cdFx0XHRcdGNvbnN0IHNhbml0aXplID0gKHM6IHN0cmluZykgPT4gcy50b1N0cmluZygpLnJlcGxhY2UoL1xccj9cXG4kL21nLCAnJyk7XG5cdFx0XHRcdHRoaXMuX2FkYXB0ZXJQcm9jZXNzLnN0ZGVyci5vbignZGF0YScsIChkYXRhOiBzdHJpbmcpID0+IHtcblx0XHRcdFx0XHRpZiAodGhpcy5fZW5hYmxlU3RkZXJyKSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhzYW5pdGl6ZShkYXRhKSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHR0aGlzLl9hZGFwdGVyUHJvY2Vzcy5vbignZXJyb3InLCAoZXJyKSA9PiB7XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coZXJyKTtcblx0XHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHRoaXMuX2FkYXB0ZXJQcm9jZXNzLm9uKCdleGl0JywgKGNvZGU6IG51bWJlciwgc2lnbmFsOiBzdHJpbmcpID0+IHtcblx0XHRcdFx0XHRpZiAoY29kZSkge1xuXHRcdFx0XHRcdFx0Ly8gZG9uZShuZXcgRXJyb3IoJ2RlYnVnIGFkYXB0ZXIgZXhpdCBjb2RlOiAnICsgY29kZSkpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0dGhpcy5jb25uZWN0KHRoaXMuX2FkYXB0ZXJQcm9jZXNzLnN0ZG91dCwgdGhpcy5fYWRhcHRlclByb2Nlc3Muc3RkaW4pO1xuXHRcdFx0XHRyZXNvbHZlKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcblx0ICogU2h1dGRvd24gdGhlIGRlYnVnZ2VlIGFuZCB0aGUgZGVidWcgYWRhcHRlciAob3IgZGlzY29ubmVjdCBpZiBpbiBzZXJ2ZXIgbW9kZSkuXG5cdCAqL1xuXHRwdWJsaWMgc3RvcCgpOiBQcm9taXNlPHZvaWQ+IHtcblxuXHRcdHJldHVybiB0aGlzLmRpc2Nvbm5lY3RSZXF1ZXN0KCkudGhlbigoKSA9PiB7XG5cdFx0XHR0aGlzLnN0b3BBZGFwdGVyKCk7XG5cdFx0fSkuY2F0Y2goKCkgPT4ge1xuXHRcdFx0dGhpcy5zdG9wQWRhcHRlcigpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBzdG9wQWRhcHRlcigpIHtcblx0XHRpZiAodGhpcy5fYWRhcHRlclByb2Nlc3MpIHtcblx0XHRcdHRoaXMuX2FkYXB0ZXJQcm9jZXNzLmtpbGwoKTtcblx0XHRcdHRoaXMuX2FkYXB0ZXJQcm9jZXNzID0gbnVsbDtcblx0XHR9XG5cdFx0aWYgKHRoaXMuX3NvY2tldCkge1xuXHRcdFx0dGhpcy5fc29ja2V0LmVuZCgpO1xuXHRcdFx0dGhpcy5fc29ja2V0ID0gbnVsbDtcblx0XHR9XG5cdH1cblxuXHQvLyAtLS0tIHByb3RvY29sIHJlcXVlc3RzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXHRwdWJsaWMgaW5pdGlhbGl6ZVJlcXVlc3QoYXJncz86IERlYnVnUHJvdG9jb2wuSW5pdGlhbGl6ZVJlcXVlc3RBcmd1bWVudHMpOiBQcm9taXNlPERlYnVnUHJvdG9jb2wuSW5pdGlhbGl6ZVJlc3BvbnNlPiB7XG5cdFx0aWYgKCFhcmdzKSB7XG5cdFx0XHRhcmdzID0ge1xuXHRcdFx0XHRhZGFwdGVySUQ6IHRoaXMuX2RlYnVnVHlwZSxcblx0XHRcdFx0bGluZXNTdGFydEF0MTogdHJ1ZSxcblx0XHRcdFx0Y29sdW1uc1N0YXJ0QXQxOiB0cnVlLFxuXHRcdFx0XHRwYXRoRm9ybWF0OiAncGF0aCdcblx0XHRcdH07XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLnNlbmQoJ2luaXRpYWxpemUnLCBhcmdzKTtcblx0fVxuXG5cdHB1YmxpYyBjb25maWd1cmF0aW9uRG9uZVJlcXVlc3QoYXJncz86IERlYnVnUHJvdG9jb2wuQ29uZmlndXJhdGlvbkRvbmVBcmd1bWVudHMpOiBQcm9taXNlPERlYnVnUHJvdG9jb2wuQ29uZmlndXJhdGlvbkRvbmVSZXNwb25zZT4ge1xuXHRcdHJldHVybiB0aGlzLnNlbmQoJ2NvbmZpZ3VyYXRpb25Eb25lJywgYXJncyk7XG5cdH1cblxuXHRwdWJsaWMgbGF1bmNoUmVxdWVzdChhcmdzOiBEZWJ1Z1Byb3RvY29sLkxhdW5jaFJlcXVlc3RBcmd1bWVudHMpOiBQcm9taXNlPERlYnVnUHJvdG9jb2wuTGF1bmNoUmVzcG9uc2U+IHtcblx0XHRyZXR1cm4gdGhpcy5zZW5kKCdsYXVuY2gnLCBhcmdzKTtcblx0fVxuXG5cdHB1YmxpYyBhdHRhY2hSZXF1ZXN0KGFyZ3M6IERlYnVnUHJvdG9jb2wuQXR0YWNoUmVxdWVzdEFyZ3VtZW50cyk6IFByb21pc2U8RGVidWdQcm90b2NvbC5BdHRhY2hSZXNwb25zZT4ge1xuXHRcdHJldHVybiB0aGlzLnNlbmQoJ2F0dGFjaCcsIGFyZ3MpO1xuXHR9XG5cblx0cHVibGljIHJlc3RhcnRSZXF1ZXN0KGFyZ3M6IERlYnVnUHJvdG9jb2wuUmVzdGFydEFyZ3VtZW50cyk6IFByb21pc2U8RGVidWdQcm90b2NvbC5SZXN0YXJ0UmVzcG9uc2U+IHtcblx0XHRyZXR1cm4gdGhpcy5zZW5kKCdyZXN0YXJ0JywgYXJncyk7XG5cdH1cblxuXHRwdWJsaWMgdGVybWluYXRlUmVxdWVzdChhcmdzPzogRGVidWdQcm90b2NvbC5UZXJtaW5hdGVBcmd1bWVudHMpOiBQcm9taXNlPERlYnVnUHJvdG9jb2wuVGVybWluYXRlUmVzcG9uc2U+IHtcblx0XHRyZXR1cm4gdGhpcy5zZW5kKCd0ZXJtaW5hdGUnLCBhcmdzKTtcblx0fVxuXG5cdHB1YmxpYyBkaXNjb25uZWN0UmVxdWVzdChhcmdzPzogRGVidWdQcm90b2NvbC5EaXNjb25uZWN0QXJndW1lbnRzKTogUHJvbWlzZTxEZWJ1Z1Byb3RvY29sLkRpc2Nvbm5lY3RSZXNwb25zZT4ge1xuXHRcdHJldHVybiB0aGlzLnNlbmQoJ2Rpc2Nvbm5lY3QnLCBhcmdzKTtcblx0fVxuXHRcblx0cHVibGljIHNldEJyZWFrcG9pbnRzUmVxdWVzdChhcmdzOiBEZWJ1Z1Byb3RvY29sLlNldEJyZWFrcG9pbnRzQXJndW1lbnRzKTogUHJvbWlzZTxEZWJ1Z1Byb3RvY29sLlNldEJyZWFrcG9pbnRzUmVzcG9uc2U+IHtcblx0XHRyZXR1cm4gdGhpcy5zZW5kKCdzZXRCcmVha3BvaW50cycsIGFyZ3MpO1xuXHR9XG5cblx0cHVibGljIHNldEZ1bmN0aW9uQnJlYWtwb2ludHNSZXF1ZXN0KGFyZ3M6IERlYnVnUHJvdG9jb2wuU2V0RnVuY3Rpb25CcmVha3BvaW50c0FyZ3VtZW50cyk6IFByb21pc2U8RGVidWdQcm90b2NvbC5TZXRGdW5jdGlvbkJyZWFrcG9pbnRzUmVzcG9uc2U+IHtcblx0XHRyZXR1cm4gdGhpcy5zZW5kKCdzZXRGdW5jdGlvbkJyZWFrcG9pbnRzJywgYXJncyk7XG5cdH1cblxuXHRwdWJsaWMgc2V0RXhjZXB0aW9uQnJlYWtwb2ludHNSZXF1ZXN0KGFyZ3M6IERlYnVnUHJvdG9jb2wuU2V0RXhjZXB0aW9uQnJlYWtwb2ludHNBcmd1bWVudHMpOiBQcm9taXNlPERlYnVnUHJvdG9jb2wuU2V0RXhjZXB0aW9uQnJlYWtwb2ludHNSZXNwb25zZT4ge1xuXHRcdHJldHVybiB0aGlzLnNlbmQoJ3NldEV4Y2VwdGlvbkJyZWFrcG9pbnRzJywgYXJncyk7XG5cdH1cblxuXHRwdWJsaWMgY29udGludWVSZXF1ZXN0KGFyZ3M6IERlYnVnUHJvdG9jb2wuQ29udGludWVBcmd1bWVudHMpOiBQcm9taXNlPERlYnVnUHJvdG9jb2wuQ29udGludWVSZXNwb25zZT4ge1xuXHRcdHJldHVybiB0aGlzLnNlbmQoJ2NvbnRpbnVlJywgYXJncyk7XG5cdH1cblxuXHRwdWJsaWMgbmV4dFJlcXVlc3QoYXJnczogRGVidWdQcm90b2NvbC5OZXh0QXJndW1lbnRzKTogUHJvbWlzZTxEZWJ1Z1Byb3RvY29sLk5leHRSZXNwb25zZT4ge1xuXHRcdHJldHVybiB0aGlzLnNlbmQoJ25leHQnLCBhcmdzKTtcblx0fVxuXG5cdHB1YmxpYyBzdGVwSW5SZXF1ZXN0KGFyZ3M6IERlYnVnUHJvdG9jb2wuU3RlcEluQXJndW1lbnRzKTogUHJvbWlzZTxEZWJ1Z1Byb3RvY29sLlN0ZXBJblJlc3BvbnNlPiB7XG5cdFx0cmV0dXJuIHRoaXMuc2VuZCgnc3RlcEluJywgYXJncyk7XG5cdH1cblxuXHRwdWJsaWMgc3RlcE91dFJlcXVlc3QoYXJnczogRGVidWdQcm90b2NvbC5TdGVwT3V0QXJndW1lbnRzKTogUHJvbWlzZTxEZWJ1Z1Byb3RvY29sLlN0ZXBPdXRSZXNwb25zZT4ge1xuXHRcdHJldHVybiB0aGlzLnNlbmQoJ3N0ZXBPdXQnLCBhcmdzKTtcblx0fVxuXG5cdHB1YmxpYyBzdGVwQmFja1JlcXVlc3QoYXJnczogRGVidWdQcm90b2NvbC5TdGVwQmFja0FyZ3VtZW50cyk6IFByb21pc2U8RGVidWdQcm90b2NvbC5TdGVwQmFja1Jlc3BvbnNlPiB7XG5cdFx0cmV0dXJuIHRoaXMuc2VuZCgnc3RlcEJhY2snLCBhcmdzKTtcblx0fVxuXG5cdHB1YmxpYyByZXZlcnNlQ29udGludWVSZXF1ZXN0KGFyZ3M6IERlYnVnUHJvdG9jb2wuUmV2ZXJzZUNvbnRpbnVlQXJndW1lbnRzKTogUHJvbWlzZTxEZWJ1Z1Byb3RvY29sLlJldmVyc2VDb250aW51ZVJlc3BvbnNlPiB7XG5cdFx0cmV0dXJuIHRoaXMuc2VuZCgncmV2ZXJzZUNvbnRpbnVlJywgYXJncyk7XG5cdH1cblxuXHRwdWJsaWMgcmVzdGFydEZyYW1lUmVxdWVzdChhcmdzOiBEZWJ1Z1Byb3RvY29sLlJlc3RhcnRGcmFtZUFyZ3VtZW50cyk6IFByb21pc2U8RGVidWdQcm90b2NvbC5SZXN0YXJ0RnJhbWVSZXNwb25zZT4ge1xuXHRcdHJldHVybiB0aGlzLnNlbmQoJ3Jlc3RhcnRGcmFtZScsIGFyZ3MpO1xuXHR9XG5cblx0cHVibGljIGdvdG9SZXF1ZXN0KGFyZ3M6IERlYnVnUHJvdG9jb2wuR290b0FyZ3VtZW50cyk6IFByb21pc2U8RGVidWdQcm90b2NvbC5Hb3RvUmVzcG9uc2U+IHtcblx0XHRyZXR1cm4gdGhpcy5zZW5kKCdnb3RvJywgYXJncyk7XG5cdH1cblxuXHRwdWJsaWMgcGF1c2VSZXF1ZXN0KGFyZ3M6IERlYnVnUHJvdG9jb2wuUGF1c2VBcmd1bWVudHMpOiBQcm9taXNlPERlYnVnUHJvdG9jb2wuUGF1c2VSZXNwb25zZT4ge1xuXHRcdHJldHVybiB0aGlzLnNlbmQoJ3BhdXNlJywgYXJncyk7XG5cdH1cblxuXHRwdWJsaWMgc3RhY2tUcmFjZVJlcXVlc3QoYXJnczogRGVidWdQcm90b2NvbC5TdGFja1RyYWNlQXJndW1lbnRzKTogUHJvbWlzZTxEZWJ1Z1Byb3RvY29sLlN0YWNrVHJhY2VSZXNwb25zZT4ge1xuXHRcdHJldHVybiB0aGlzLnNlbmQoJ3N0YWNrVHJhY2UnLCBhcmdzKTtcblx0fVxuXG5cdHB1YmxpYyBzY29wZXNSZXF1ZXN0KGFyZ3M6IERlYnVnUHJvdG9jb2wuU2NvcGVzQXJndW1lbnRzKTogUHJvbWlzZTxEZWJ1Z1Byb3RvY29sLlNjb3Blc1Jlc3BvbnNlPiB7XG5cdFx0cmV0dXJuIHRoaXMuc2VuZCgnc2NvcGVzJywgYXJncyk7XG5cdH1cblxuXHRwdWJsaWMgdmFyaWFibGVzUmVxdWVzdChhcmdzOiBEZWJ1Z1Byb3RvY29sLlZhcmlhYmxlc0FyZ3VtZW50cyk6IFByb21pc2U8RGVidWdQcm90b2NvbC5WYXJpYWJsZXNSZXNwb25zZT4ge1xuXHRcdHJldHVybiB0aGlzLnNlbmQoJ3ZhcmlhYmxlcycsIGFyZ3MpO1xuXHR9XG5cblx0cHVibGljIHNldFZhcmlhYmxlUmVxdWVzdChhcmdzOiBEZWJ1Z1Byb3RvY29sLlNldFZhcmlhYmxlQXJndW1lbnRzKTogUHJvbWlzZTxEZWJ1Z1Byb3RvY29sLlNldFZhcmlhYmxlUmVzcG9uc2U+IHtcblx0XHRyZXR1cm4gdGhpcy5zZW5kKCdzZXRWYXJpYWJsZScsIGFyZ3MpO1xuXHR9XG5cblx0cHVibGljIHNvdXJjZVJlcXVlc3QoYXJnczogRGVidWdQcm90b2NvbC5Tb3VyY2VBcmd1bWVudHMpOiBQcm9taXNlPERlYnVnUHJvdG9jb2wuU291cmNlUmVzcG9uc2U+IHtcblx0XHRyZXR1cm4gdGhpcy5zZW5kKCdzb3VyY2UnLCBhcmdzKTtcblx0fVxuXG5cdHB1YmxpYyB0aHJlYWRzUmVxdWVzdCgpOiBQcm9taXNlPERlYnVnUHJvdG9jb2wuVGhyZWFkc1Jlc3BvbnNlPiB7XG5cdFx0cmV0dXJuIHRoaXMuc2VuZCgndGhyZWFkcycpO1xuXHR9XG5cblx0cHVibGljIG1vZHVsZXNSZXF1ZXN0KGFyZ3M6IERlYnVnUHJvdG9jb2wuTW9kdWxlc0FyZ3VtZW50cyk6IFByb21pc2U8RGVidWdQcm90b2NvbC5Nb2R1bGVzUmVzcG9uc2U+IHtcblx0XHRyZXR1cm4gdGhpcy5zZW5kKCdtb2R1bGVzJyk7XG5cdH1cblxuXHRwdWJsaWMgZXZhbHVhdGVSZXF1ZXN0KGFyZ3M6IERlYnVnUHJvdG9jb2wuRXZhbHVhdGVBcmd1bWVudHMpOiBQcm9taXNlPERlYnVnUHJvdG9jb2wuRXZhbHVhdGVSZXNwb25zZT4ge1xuXHRcdHJldHVybiB0aGlzLnNlbmQoJ2V2YWx1YXRlJywgYXJncyk7XG5cdH1cblxuXHRwdWJsaWMgc3RlcEluVGFyZ2V0c1JlcXVlc3QoYXJnczogRGVidWdQcm90b2NvbC5TdGVwSW5UYXJnZXRzQXJndW1lbnRzKTogUHJvbWlzZTxEZWJ1Z1Byb3RvY29sLlN0ZXBJblRhcmdldHNSZXNwb25zZT4ge1xuXHRcdHJldHVybiB0aGlzLnNlbmQoJ3N0ZXBJblRhcmdldHMnLCBhcmdzKTtcblx0fVxuXG5cdHB1YmxpYyBnb3RvVGFyZ2V0c1JlcXVlc3QoYXJnczogRGVidWdQcm90b2NvbC5Hb3RvVGFyZ2V0c0FyZ3VtZW50cyk6IFByb21pc2U8RGVidWdQcm90b2NvbC5Hb3RvVGFyZ2V0c1Jlc3BvbnNlPiB7XG5cdFx0cmV0dXJuIHRoaXMuc2VuZCgnZ290b1RhcmdldHMnLCBhcmdzKTtcblx0fVxuXG5cdHB1YmxpYyBjb21wbGV0aW9uc1JlcXVlc3QoYXJnczogRGVidWdQcm90b2NvbC5Db21wbGV0aW9uc0FyZ3VtZW50cyk6IFByb21pc2U8RGVidWdQcm90b2NvbC5Db21wbGV0aW9uc1Jlc3BvbnNlPiB7XG5cdFx0cmV0dXJuIHRoaXMuc2VuZCgnY29tcGxldGlvbnMnLCBhcmdzKTtcblx0fVxuXG5cdHB1YmxpYyBleGNlcHRpb25JbmZvUmVxdWVzdChhcmdzOiBEZWJ1Z1Byb3RvY29sLkV4Y2VwdGlvbkluZm9Bcmd1bWVudHMpOiBQcm9taXNlPERlYnVnUHJvdG9jb2wuRXhjZXB0aW9uSW5mb1Jlc3BvbnNlPiB7XG5cdFx0cmV0dXJuIHRoaXMuc2VuZCgnZXhjZXB0aW9uSW5mbycsIGFyZ3MpO1xuXHR9XG5cblx0cHVibGljIGN1c3RvbVJlcXVlc3QoY29tbWFuZDogc3RyaW5nLCBhcmdzPzogYW55KTogUHJvbWlzZTxEZWJ1Z1Byb3RvY29sLlJlc3BvbnNlPiB7XG5cdFx0cmV0dXJuIHRoaXMuc2VuZChjb21tYW5kLCBhcmdzKTtcblx0fVxuXG5cdC8vIC0tLS0gY29udmVuaWVuY2UgbWV0aG9kcyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdC8qXG5cdCAqIFJldHVybnMgYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIGlmIGFuIGV2ZW50IHdpdGggYSBzcGVjaWZpYyB0eXBlIHdhcyByZWNlaXZlZCB3aXRoaW4gc29tZSBzcGVjaWZpZWQgdGltZS5cblx0ICogVGhlIHByb21pc2Ugd2lsbCBiZSByZWplY3RlZCBpZiBhIHRpbWVvdXQgb2NjdXJzLlxuXHQgKi9cblx0cHVibGljIHdhaXRGb3JFdmVudChldmVudFR5cGU6IHN0cmluZywgdGltZW91dD86IG51bWJlcik6IFByb21pc2U8RGVidWdQcm90b2NvbC5FdmVudD4ge1xuXG5cdFx0dGltZW91dCA9IHRpbWVvdXQgfHwgdGhpcy5kZWZhdWx0VGltZW91dDtcblxuXHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHR0aGlzLm9uY2UoZXZlbnRUeXBlLCBldmVudCA9PiB7XG5cdFx0XHRcdHJlc29sdmUoZXZlbnQpO1xuXHRcdFx0fSk7XG5cdFx0XHRpZiAoIXRoaXMuX3NvY2tldCkge1x0Ly8gbm8gdGltZW91dHMgaWYgZGVidWdnaW5nIHRoZSB0ZXN0c1xuXHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRyZWplY3QobmV3IEVycm9yKGBubyBldmVudCAnJHtldmVudFR5cGV9JyByZWNlaXZlZCBhZnRlciAke3RpbWVvdXR9IG1zYCkpO1xuXHRcdFx0XHR9LCB0aW1lb3V0KTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cdC8qXG5cdCAqIFJldHVybnMgYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIGlmIGFuICdpbml0aWFsaXplZCcgZXZlbnQgd2FzIHJlY2VpdmVkIHdpdGhpbiBzb21lIHNwZWNpZmllZCB0aW1lXG5cdCAqIGFuZCBhIHN1YnNlcXVlbnQgJ2NvbmZpZ3VyYXRpb25Eb25lJyByZXF1ZXN0IHdhcyBzdWNjZXNzZnVsbHkgZXhlY3V0ZWQuXG5cdCAqIFRoZSBwcm9taXNlIHdpbGwgYmUgcmVqZWN0ZWQgaWYgYSB0aW1lb3V0IG9jY3VycyBvciBpZiB0aGUgJ2NvbmZpZ3VyYXRpb25Eb25lJyByZXF1ZXN0IGZhaWxzLlxuXHQgKi9cblx0cHVibGljIGNvbmZpZ3VyYXRpb25TZXF1ZW5jZSgpOiBQcm9taXNlPGFueT4ge1xuXG5cdFx0cmV0dXJuIHRoaXMud2FpdEZvckV2ZW50KCdpbml0aWFsaXplZCcpLnRoZW4oZXZlbnQgPT4ge1xuXHRcdFx0cmV0dXJuIHRoaXMuY29uZmlndXJhdGlvbkRvbmUoKTtcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSBpZiBhICdpbml0aWFsaXplJyBhbmQgYSAnbGF1bmNoJyByZXF1ZXN0IHdlcmUgc3VjY2Vzc2Z1bC5cblx0ICovXG5cdHB1YmxpYyBsYXVuY2gobGF1bmNoQXJnczogYW55KTogUHJvbWlzZTxEZWJ1Z1Byb3RvY29sLkxhdW5jaFJlc3BvbnNlPiB7XG5cblx0XHRyZXR1cm4gdGhpcy5pbml0aWFsaXplUmVxdWVzdCgpLnRoZW4ocmVzcG9uc2UgPT4ge1xuXHRcdFx0aWYgKHJlc3BvbnNlLmJvZHkgJiYgcmVzcG9uc2UuYm9keS5zdXBwb3J0c0NvbmZpZ3VyYXRpb25Eb25lUmVxdWVzdCkge1xuXHRcdFx0XHR0aGlzLl9zdXBwb3J0c0NvbmZpZ3VyYXRpb25Eb25lUmVxdWVzdCA9IHRydWU7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdGhpcy5sYXVuY2hSZXF1ZXN0KGxhdW5jaEFyZ3MpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHJpdmF0ZSBjb25maWd1cmF0aW9uRG9uZSgpIDogUHJvbWlzZTxEZWJ1Z1Byb3RvY29sLlJlc3BvbnNlPiB7XG5cdFx0aWYgKHRoaXMuX3N1cHBvcnRzQ29uZmlndXJhdGlvbkRvbmVSZXF1ZXN0KSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5jb25maWd1cmF0aW9uRG9uZVJlcXVlc3QoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gaWYgZGVidWcgYWRhcHRlciBkb2Vzbid0IHN1cHBvcnQgdGhlIGNvbmZpZ3VyYXRpb25Eb25lUmVxdWVzdCB3ZSBoYXZlIHRvIHNlbmQgdGhlIHNldEV4Y2VwdGlvbkJyZWFrcG9pbnRzUmVxdWVzdC5cblx0XHRcdHJldHVybiB0aGlzLnNldEV4Y2VwdGlvbkJyZWFrcG9pbnRzUmVxdWVzdCh7IGZpbHRlcnM6IFsgJ2FsbCcgXSB9KTtcblx0XHR9XG5cdH1cblxuXHQvKlxuXHQgKiBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHdpbGwgcmVzb2x2ZSBpZiBhICdzdG9wcGVkJyBldmVudCB3YXMgcmVjZWl2ZWQgd2l0aGluIHNvbWUgc3BlY2lmaWVkIHRpbWVcblx0ICogYW5kIHRoZSBldmVudCdzIHJlYXNvbiBhbmQgbGluZSBudW1iZXIgd2FzIGFzc2VydGVkLlxuXHQgKiBUaGUgcHJvbWlzZSB3aWxsIGJlIHJlamVjdGVkIGlmIGEgdGltZW91dCBvY2N1cnMsIHRoZSBhc3NlcnRpb25zIGZhaWwsIG9yIGlmIHRoZSAnc3RhY2tUcmFjZScgcmVxdWVzdCBmYWlscy5cblx0ICovXG5cdHB1YmxpYyBhc3NlcnRTdG9wcGVkTG9jYXRpb24ocmVhc29uOiBzdHJpbmcsIGV4cGVjdGVkOiB7IHBhdGg/OiBzdHJpbmcgfCBSZWdFeHAsIGxpbmU/OiBudW1iZXIsIGNvbHVtbj86IG51bWJlciB9ICkgOiBQcm9taXNlPERlYnVnUHJvdG9jb2wuU3RhY2tUcmFjZVJlc3BvbnNlPiB7XG5cblx0XHRyZXR1cm4gdGhpcy53YWl0Rm9yRXZlbnQoJ3N0b3BwZWQnKS50aGVuKGV2ZW50ID0+IHtcblx0XHRcdGFzc2VydC5lcXVhbChldmVudC5ib2R5LnJlYXNvbiwgcmVhc29uKTtcblx0XHRcdHJldHVybiB0aGlzLnN0YWNrVHJhY2VSZXF1ZXN0KHtcblx0XHRcdFx0dGhyZWFkSWQ6IGV2ZW50LmJvZHkudGhyZWFkSWRcblx0XHRcdH0pO1xuXHRcdH0pLnRoZW4ocmVzcG9uc2UgPT4ge1xuXHRcdFx0Y29uc3QgZnJhbWUgPSByZXNwb25zZS5ib2R5LnN0YWNrRnJhbWVzWzBdO1xuXHRcdFx0aWYgKHR5cGVvZiBleHBlY3RlZC5wYXRoID09PSAnc3RyaW5nJyB8fCBleHBlY3RlZC5wYXRoIGluc3RhbmNlb2YgUmVnRXhwKSB7XG5cdFx0XHRcdHRoaXMuYXNzZXJ0UGF0aChmcmFtZS5zb3VyY2UucGF0aCwgZXhwZWN0ZWQucGF0aCwgJ3N0b3BwZWQgbG9jYXRpb246IHBhdGggbWlzbWF0Y2gnKTtcblx0XHRcdH1cblx0XHRcdGlmICh0eXBlb2YgZXhwZWN0ZWQubGluZSA9PT0gJ251bWJlcicpIHtcblx0XHRcdFx0YXNzZXJ0LmVxdWFsKGZyYW1lLmxpbmUsIGV4cGVjdGVkLmxpbmUsICdzdG9wcGVkIGxvY2F0aW9uOiBsaW5lIG1pc21hdGNoJyk7XG5cdFx0XHR9XG5cdFx0XHRpZiAodHlwZW9mIGV4cGVjdGVkLmNvbHVtbiA9PT0gJ251bWJlcicpIHtcblx0XHRcdFx0YXNzZXJ0LmVxdWFsKGZyYW1lLmNvbHVtbiwgZXhwZWN0ZWQuY29sdW1uLCAnc3RvcHBlZCBsb2NhdGlvbjogY29sdW1uIG1pc21hdGNoJyk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gcmVzcG9uc2U7XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIGFzc2VydFBhcnRpYWxMb2NhdGlvbnNFcXVhbChsb2NBOiBJUGFydGlhbExvY2F0aW9uLCBsb2NCOiBJUGFydGlhbExvY2F0aW9uKTogdm9pZCB7XG5cdFx0aWYgKGxvY0EucGF0aCkge1xuXHRcdFx0dGhpcy5hc3NlcnRQYXRoKGxvY0EucGF0aCwgbG9jQi5wYXRoLCAnYnJlYWtwb2ludCB2ZXJpZmljYXRpb24gbWlzbWF0Y2g6IHBhdGgnKTtcblx0XHR9XG5cdFx0aWYgKHR5cGVvZiBsb2NBLmxpbmUgPT09ICdudW1iZXInKSB7XG5cdFx0XHRhc3NlcnQuZXF1YWwobG9jQS5saW5lLCBsb2NCLmxpbmUsICdicmVha3BvaW50IHZlcmlmaWNhdGlvbiBtaXNtYXRjaDogbGluZScpO1xuXHRcdH1cblx0XHRpZiAodHlwZW9mIGxvY0IuY29sdW1uID09PSAnbnVtYmVyJyAmJiB0eXBlb2YgbG9jQS5jb2x1bW4gPT09ICdudW1iZXInKSB7XG5cdFx0XHRhc3NlcnQuZXF1YWwobG9jQS5jb2x1bW4sIGxvY0IuY29sdW1uLCAnYnJlYWtwb2ludCB2ZXJpZmljYXRpb24gbWlzbWF0Y2g6IGNvbHVtbicpO1xuXHRcdH1cblx0fVxuXG5cdC8qXG5cdCAqIFJldHVybnMgYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIGlmIGVub3VnaCBvdXRwdXQgZXZlbnRzIHdpdGggdGhlIGdpdmVuIGNhdGVnb3J5IGhhdmUgYmVlbiByZWNlaXZlZFxuXHQgKiBhbmQgdGhlIGNvbmNhdGVuYXRlZCBkYXRhIG1hdGNoIHRoZSBleHBlY3RlZCBkYXRhLlxuXHQgKiBUaGUgcHJvbWlzZSB3aWxsIGJlIHJlamVjdGVkIGFzIHNvb24gYXMgdGhlIHJlY2VpdmVkIGRhdGEgY2Fubm90IG1hdGNoIHRoZSBleHBlY3RlZCBkYXRhIG9yIGlmIGEgdGltZW91dCBvY2N1cnMuXG5cdCAqL1xuXHRwdWJsaWMgYXNzZXJ0T3V0cHV0KGNhdGVnb3J5OiBzdHJpbmcsIGV4cGVjdGVkOiBzdHJpbmcsIHRpbWVvdXQ/OiBudW1iZXIpOiBQcm9taXNlPERlYnVnUHJvdG9jb2wuRXZlbnQ+IHtcblxuXHRcdHRpbWVvdXQgPSB0aW1lb3V0IHx8IHRoaXMuZGVmYXVsdFRpbWVvdXQ7XG5cblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0bGV0IG91dHB1dCA9ICcnO1xuXHRcdFx0dGhpcy5vbignb3V0cHV0JywgZXZlbnQgPT4ge1xuXHRcdFx0XHRjb25zdCBlID0gPERlYnVnUHJvdG9jb2wuT3V0cHV0RXZlbnQ+IGV2ZW50O1xuXHRcdFx0XHRpZiAoZS5ib2R5LmNhdGVnb3J5ID09PSBjYXRlZ29yeSkge1xuXHRcdFx0XHRcdG91dHB1dCArPSBlLmJvZHkub3V0cHV0O1xuXHRcdFx0XHRcdGlmIChvdXRwdXQuaW5kZXhPZihleHBlY3RlZCkgPT09IDApIHtcblx0XHRcdFx0XHRcdHJlc29sdmUoZXZlbnQpO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAoZXhwZWN0ZWQuaW5kZXhPZihvdXRwdXQpICE9PSAwKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBzYW5pdGl6ZSA9IChzOiBzdHJpbmcpID0+IHMudG9TdHJpbmcoKS5yZXBsYWNlKC9cXHIvbWcsICdcXFxccicpLnJlcGxhY2UoL1xcbi9tZywgJ1xcXFxuJyk7XG5cdFx0XHRcdFx0XHRyZWplY3QobmV3IEVycm9yKGByZWNlaXZlZCBkYXRhICcke3Nhbml0aXplKG91dHB1dCl9JyBpcyBub3QgYSBwcmVmaXggb2YgdGhlIGV4cGVjdGVkIGRhdGEgJyR7c2FuaXRpemUoZXhwZWN0ZWQpfSdgKSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdGlmICghdGhpcy5fc29ja2V0KSB7XHQvLyBubyB0aW1lb3V0cyBpZiBkZWJ1Z2dpbmcgdGhlIHRlc3RzXG5cdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdHJlamVjdChuZXcgRXJyb3IoYG5vdCBlbm91Z2ggb3V0cHV0IGRhdGEgcmVjZWl2ZWQgYWZ0ZXIgJHt0aW1lb3V0fSBtc2ApKTtcblx0XHRcdFx0fSwgdGltZW91dCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRwdWJsaWMgYXNzZXJ0UGF0aChwYXRoOiBzdHJpbmcsIGV4cGVjdGVkOiBzdHJpbmcgfCBSZWdFeHAsIG1lc3NhZ2U/OiBzdHJpbmcpIHtcblxuXHRcdGlmIChleHBlY3RlZCBpbnN0YW5jZW9mIFJlZ0V4cCkge1xuXHRcdFx0YXNzZXJ0Lm9rKCg8UmVnRXhwPmV4cGVjdGVkKS50ZXN0KHBhdGgpLCBtZXNzYWdlKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKERlYnVnQ2xpZW50LkNBU0VfSU5TRU5TSVRJVkVfRklMRVNZU1RFTSkge1xuXHRcdFx0XHRpZiAodHlwZW9mIHBhdGggPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0cGF0aCA9IHBhdGgudG9Mb3dlckNhc2UoKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAodHlwZW9mIGV4cGVjdGVkID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdGV4cGVjdGVkID0gKDxzdHJpbmc+ZXhwZWN0ZWQpLnRvTG93ZXJDYXNlKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGFzc2VydC5lcXVhbChwYXRoLCBleHBlY3RlZCwgbWVzc2FnZSk7XG5cdFx0fVxuXHR9XG5cblx0Ly8gLS0tLSBzY2VuYXJpb3MgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0LyoqXG5cdCAqIFJldHVybnMgYSBwcm9taXNlIHRoYXQgd2lsbCByZXNvbHZlIGlmIGEgY29uZmlndXJhYmxlIGJyZWFrcG9pbnQgaGFzIGJlZW4gaGl0IHdpdGhpbiBzb21lIHRpbWVcblx0ICogYW5kIHRoZSBldmVudCdzIHJlYXNvbiBhbmQgbGluZSBudW1iZXIgd2FzIGFzc2VydGVkLlxuXHQgKiBUaGUgcHJvbWlzZSB3aWxsIGJlIHJlamVjdGVkIGlmIGEgdGltZW91dCBvY2N1cnMsIHRoZSBhc3NlcnRpb25zIGZhaWwsIG9yIGlmIHRoZSByZXF1ZXN0cyBmYWlscy5cblx0ICovXG5cdHB1YmxpYyBoaXRCcmVha3BvaW50KGxhdW5jaEFyZ3M6IGFueSwgbG9jYXRpb246IElMb2NhdGlvbiwgZXhwZWN0ZWRTdG9wTG9jYXRpb24/OiBJUGFydGlhbExvY2F0aW9uLCBleHBlY3RlZEJQTG9jYXRpb24/OiBJUGFydGlhbExvY2F0aW9uKSA6IFByb21pc2U8YW55PiB7XG5cblx0XHRyZXR1cm4gUHJvbWlzZS5hbGwoW1xuXG5cdFx0XHR0aGlzLndhaXRGb3JFdmVudCgnaW5pdGlhbGl6ZWQnKS50aGVuKGV2ZW50ID0+IHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuc2V0QnJlYWtwb2ludHNSZXF1ZXN0KHtcblx0XHRcdFx0XHRsaW5lczogWyBsb2NhdGlvbi5saW5lIF0sXG5cdFx0XHRcdFx0YnJlYWtwb2ludHM6IFsgeyBsaW5lOiBsb2NhdGlvbi5saW5lLCBjb2x1bW46IGxvY2F0aW9uLmNvbHVtbiB9IF0sXG5cdFx0XHRcdFx0c291cmNlOiB7IHBhdGg6IGxvY2F0aW9uLnBhdGggfVxuXHRcdFx0XHR9KTtcblx0XHRcdH0pLnRoZW4ocmVzcG9uc2UgPT4ge1xuXG5cdFx0XHRcdGNvbnN0IGJwID0gcmVzcG9uc2UuYm9keS5icmVha3BvaW50c1swXTtcblxuXHRcdFx0XHRjb25zdCB2ZXJpZmllZCA9ICh0eXBlb2YgbG9jYXRpb24udmVyaWZpZWQgPT09ICdib29sZWFuJykgPyBsb2NhdGlvbi52ZXJpZmllZCA6IHRydWU7XG5cdFx0XHRcdGFzc2VydC5lcXVhbChicC52ZXJpZmllZCwgdmVyaWZpZWQsICdicmVha3BvaW50IHZlcmlmaWNhdGlvbiBtaXNtYXRjaDogdmVyaWZpZWQnKTtcblxuXHRcdFx0XHRjb25zdCBhY3R1YWxMb2NhdGlvbjogSUxvY2F0aW9uID0ge1xuXHRcdFx0XHRcdGNvbHVtbjogYnAuY29sdW1uLFxuXHRcdFx0XHRcdGxpbmU6IGJwLmxpbmUsXG5cdFx0XHRcdFx0cGF0aDogYnAuc291cmNlICYmIGJwLnNvdXJjZS5wYXRoXG5cdFx0XHRcdH07XG5cdFx0XHRcdHRoaXMuYXNzZXJ0UGFydGlhbExvY2F0aW9uc0VxdWFsKGFjdHVhbExvY2F0aW9uLCBleHBlY3RlZEJQTG9jYXRpb24gfHwgbG9jYXRpb24pO1xuXG5cdFx0XHRcdHJldHVybiB0aGlzLmNvbmZpZ3VyYXRpb25Eb25lKCk7XG5cdFx0XHR9KSxcblxuXHRcdFx0dGhpcy5sYXVuY2gobGF1bmNoQXJncyksXG5cblx0XHRcdHRoaXMuYXNzZXJ0U3RvcHBlZExvY2F0aW9uKCdicmVha3BvaW50JywgZXhwZWN0ZWRTdG9wTG9jYXRpb24gfHwgbG9jYXRpb24pXG5cblx0XHRdKTtcblx0fVxufVxuIl19